编译MPI的记录：
在电脑上分别编译和安装了openmpi-3.1和mpich2-3.4 (3.3),发现两者有区别：

mpich2-3.4的lib中，有libmpi.so.12; 
而openmpi的lib中，是libmpi.so.40; 另外还有很多mpich2没有的so文件，例如libmpi_mpifh.so等，很多是编译ESMF_7.1所需要的。建议使用openmpi-3.1

可见，mpich2库的开发是滞后于openmpi库的开发的。但是还没尝试使用mpich2-4.x版本的库来编译ESMF。

编译ESMF-7.1的记录：
使用mpich2-3.4编译时，没有设置export ESMF_CXXCOMPILER=mpicxx;export ESMF_F90COMPILER=mpif90,出现编译错误：使用g++不能连接mpi.h
使用mpich2-3.4编译ESMF还有不能连接有关libmpi.so等库的问题。
因此，必须使用openmpi-3.1编译ESMF。

gedit ~/.bashrc

## Ubuntu 18.04 apt-get install默认路径: include: /usr/include/  lib: /usr/lib/x86_64-linux-gnu/
export LD_LIBRARY_PATH=/usr/lib/x86_64-linux-gnu/:$LD_LIBRARY_PATH

# set MPICH2-3.4 env. variable
export MPI_ROOT=/home/lijian/openmpi_install
export PATH=$MPI_ROOT/bin:$PATH
export LD_LIBRARY_PATH=$MPI_ROOT/lib:$LD_LIBRARY_PATH
export CPATH=$MPI_ROOT/lib:$CPATH

#------------config for ESMF-7.1--------------------------------------------------
export ESMF_OS=Linux
export ESMF_TESTMPMD=OFF
export ESMF_TESTEXHAUSTIVE=OFF
export ESMF_TESTHARNESS_ARRAY=RUN_ESMF_TestHarnessArray_default
export ESMF_TESTHARNESS_FIELD=RUN_ESMF_TestHarnessField_default
export ESMF_DIR=/home/lijian/esmf-7.1.0
export ESMF_TESTWITHTHREADS=OFF
export ESMF_INSTALL_PREFIX=/home/lijian/esmf-7.1.0/install_dir
export ESMF_COMM=openmpi
export ESMF_TESTEXHAUSTIVE=ON
export ESMF_BOPT=O
export ESMF_OPENMP=OFF
export ESMF_SITE=default
export ESMF_ABI=64
export ESMF_COMPILER=gfortran
export ESMF_CXXCOMPILER=mpic++
export ESMF_F90COMPILER=mpif90
export ESMF_YAMLCPP=OFF
export ESMF_PIO=internal
export ESMF_NETCDF=split
export ESMF_NETCDF_INCLUDE="/usr/include"
export ESMF_NETCDF_LIBPATH="/usr/lib/x86_64-linux-gnu"
export ESMF_NETCDF_LIBS="-lnetcdf -lnetcdff"
export ESMF_XERCES=standard
export ESMF_XERCES_INCLUDE="/usr/include"
export ESMF_XERCES_LIBPATH="/usr/lib/x86_64-linux-gnu"

### Add the path of libraries as environmental variables
export ESMF_INC=$ESMF_INSTALL_PREFIX/include
export ESMF_LIB=$ESMF_INSTALL_PREFIX/lib/libO/Linux.gfortran.64.openmpi.default
export ESMFMKFILE=$ESMF_LIB/esmf.mk
#---------------end of ESMF-7.1 configuration-----------------------------------

# Paraview 5.4.1 shared libraries
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/lib/paraview-5.4/

然后, source ~/.bashrc

make -j8
make ESMF_BOPT=O build_system_tests
make check 
make install

