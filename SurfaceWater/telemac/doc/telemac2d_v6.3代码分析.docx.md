（1）以Telemac2d_v6.3版本，分析代码结构：

  ---------------------------------------------------------------------------------------
  主程序名             调用子程序                  说明
  -------------------- --------------------------- --------------------------------------
  homere_telemac2d.f   [BIEF_INIT]{.mark}          并行化初始程序

                       [LECDON_TELEMAC2D]{.mark}   读取控制文件

                       [BIEF_OPEN_FILES]{.mark}    文件控制

                       [POINT_TELEMAC2D]{.mark}    分配数组内存

                       [INITIALISES                初始化泥沙模型
                       SISYPHE]{.mark}             

                       [INITIALISES                初始化波浪模型
                       TOMAWAC]{.mark}             

                       **[TELEMAC2D]{.mark}**      调用telemac2d时间循环的核心程序

                       [HOMERE_ADJ_T2D]{.mark}     [运行参数评估模式,做参数率定]{.mark}

                       [BIEF_CLOSE_FILES]{.mark}   [关闭文件]{.mark}

                       [...]{.mark}                [关闭SISYPHE和TOMAWAC文件]{.mark}

                       [ELAPSE]{.mark}             [计算cpu 耗时]{.mark}
  ---------------------------------------------------------------------------------------

  --------------------------------------------------------------------------------------
                         调用子程序             说明
  ---------------------- ---------------------- ----------------------------------------
  [BIEF_INIT]{.mark}.f   [P_INIT]{.mark}        [并行计算模式]{.mark}，读取PARAL文件

                         [READ_CONFIG]{.mark}   [读取CONFIG文件（只有2个参数）]{.mark}
  --------------------------------------------------------------------------------------

+----------------------+----------------------+------------------------+
|                      | 调用子程序           | 说明                   |
+======================+======================+========================+
| [LECDON              | 初始化向量为默认值   |                        |
| _TELEMAC2D]{.mark}.f |                      |                        |
+----------------------+----------------------+------------------------+
| 控制和字典文件都在   | [初始化              | [DAMOCLE]{.ma          |
| LECDON中打开和关闭； | DA                   | rk}S：操作文件的一个库 |
|                      | MOCLES]{.mark}的变量 |                        |
| 设置telemac2d的控    |                      |                        |
| 制参数值，都在此完成 |                      |                        |
+----------------------+----------------------+------------------------+
|                      | [CALL                | [打开                  |
|                      | DAMOCLE]{.mark}      | 字典和控制文件]{.mark} |
+----------------------+----------------------+------------------------+
|                      | [CALL                | 读取steeri             |
|                      | READ_SUBMIT]{.mark}  | ng文件中的文件名，存储 |
|                      |                      | 于BIEF_FILE结构文件中  |
+----------------------+----------------------+------------------------+
|                      | [定义telemac2d中的F  | 可                     |
|                      | ORTRAN文件号]{.mark} | 定义文件名和文件逻辑号 |
+----------------------+----------------------+------------------------+
|                      | [将s                 | 大量                   |
|                      | teering文件值分配给F | 使用[MOTINT]{.mark}、[ |
|                      | ORTRAN参数名]{.mark} | MOTREA]{.mark}、[MOTLO |
|                      |                      | G]{.mark}、[MOTCAR]{.m |
|                      |                      | ark}，将控制文件中的设 |
|                      |                      | 置值付给实际的计算变量 |
+----------------------+----------------------+------------------------+

+----------------------+-----------------------+-----------------------+
|                      | 调用子程序            | 说明                  |
+======================+=======================+=======================+
| [BIE                 |                       |                       |
| F_OPEN_FILES]{.mark} |                       |                       |
+----------------------+-----------------------+-----------------------+
| 打开所有在stee       | [DO                   | 分                    |
| ring文件中定义的文件 | I=1,NFILES]{.mark}    | ASC和MED两种格式打开  |
|                      |                       |                       |
|                      | ENDDO                 |                       |
+----------------------+-----------------------+-----------------------+

  -----------------------------------------------------------------------------------
                             调用子程序                      说明
  -------------------------- ------------------------------- ------------------------
  [POINT_TELEMAC2D]{.mark}                                   

                             [CALL ALMESH]{.mark}            计算非结构网格拓扑结构

                             [BIEF_ALLVEC]{.mark}            分配结构体内存空间

                             [BIEF_ALLVEC_IN_BLOCK]{.mark}   
  -----------------------------------------------------------------------------------

（2）TELEMAC2D.f是整个模型的核心程序，仔细理解参数意义：

+----------------------+------------------------+----------------------+
| TELEMAC2D.f          | 调用子程序             | 说明                 |
+======================+========================+======================+
| 核心程序             | [分                    | [有                  |
|                      | 为若干个阶段：]{.mark} | 限元的单元离散类型:  |
|                      |                        | P1]{.mark} 三角单元  |
|                      | 1、读取控              |                      |
|                      | 制文件、边界条件、地形 |                      |
+----------------------+------------------------+----------------------+
| [CALL                | [CALL LECLIM]{.mark}   | 读取边界             |
| TELE                 |                        | 条件和边界节点属性值 |
| MAC2D(PASS=-1,ATDEP= |                        |                      |
| 0.D0,NITER=0,CODE=\' |                        |                      |
| \')]{.mark}          |                        |                      |
|                      |                        |                      |
| 根据Sain             |                        |                      |
| t-Venant方程，求解U, |                        |                      |
| V, H                 |                        |                      |
|                      |                        |                      |
| [ADJO = .TRUE. :     |                        |                      |
| DIRECT MODE]{.mark}  |                        |                      |
|                      |                        |                      |
| [ADJO = .FALSE. :    |                        |                      |
| ADJOINT MODE]{.mark} |                        |                      |
+----------------------+------------------------+----------------------+
|                      | [CALL INBIEF]{.mark}   | 补充描述BI           |
|                      |                        | EF有限元库的数据结构 |
|                      | [I                     |                      |
|                      | F(IELMX.EQ.13)]{.mark} |                      |
|                      | THEN                   |                      |
|                      |                        |                      |
|                      | [CALL COMPLIM]{.mark}  |                      |
|                      |                        |                      |
|                      | ENDIF                  |                      |
+----------------------+------------------------+----------------------+
| [USE                 | [IF(DEFZON) CALL       | [DEFINITION OF ZONES |
| INTERFACE_SISYPHE,   | DEF_ZONES]{.mark}      | BY THE USER]{.mark}  |
| ONLY:                |                        |                      |
| SISYPHE]{.mark}      | [IF(NPTS               | [CHANGES FROM GLOBAL |
|                      | .GT.0.AND.NCSIZE.GT.1) | TO LOCAL IN LIST OF  |
| [USE                 | THEN]{.mark}           | POINTS IN            |
| INTERFACE_TOMAWAC,   |                        | PARALLEL]{.mark}     |
| ONLY: WAC]{.mark}    | [DO I=1,NPTS]{.mark}   |                      |
|                      |                        |                      |
| [USE                 | [L                     |                      |
| OILSPILL]{.mark}     | IST_PTS(I)=MESH%KNOGL% |                      |
|                      | I(LIST_PTS(I))]{.mark} |                      |
| [USE                 |                        |                      |
| ALGAE_TRANSP]{.mark} | [ENDDO]{.mark}         |                      |
|                      |                        |                      |
|                      | [ENDIF]{.mark}         |                      |
+----------------------+------------------------+----------------------+
|                      | [FONSTR]{.mark}        | 读取地形和摩阻等文件 |
+----------------------+------------------------+----------------------+
|                      | [FRICTION_CH           | [分区初              |
|                      | OICE(0,KARMAN)]{.mark} | 始化摩阻系数]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [                      | [准备                |
|                      | CREATE_DATASET]{.mark} | 输出数据文件]{.mark} |
|                      |                        |                      |
|                      | [WRITE_MESH]{.mark}    | [输出网格数据文件    |
|                      |                        | （计算结果）]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [CHGDIS]{.mark}        | [INITIALISES         |
|                      |                        | PRIVE？？？]{.mark}  |
+----------------------+------------------------+----------------------+
|                      | [FRONT2]{.mark}        | [                    |
|                      |                        | 定位边界位置]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [R                     | [读取水位\~          |
|                      | EAD_FIC_CURVES]{.mark} | 流量边界条件]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [CORNOR]{.mark}        | [修正边界节          |
|                      |                        | 点的法向方向]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [MASKOB]{.mark}        | [用户自定义mask      |
|                      |                        | cell]{.mark}         |
+----------------------+------------------------+----------------------+
|                      | [MASBAS2D]{.mark}      | [INTEGRAL OF TEST    |
|                      |                        | FUN                  |
|                      |                        | CTIONS？？？]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [CHGDIS]{.mark}        | [用户自              |
|                      |                        | 定义修正地形]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [SO                    | [再定义源项]{.mark}  |
|                      | URCE_TELEMAC2D]{.mark} |                      |
+----------------------+------------------------+----------------------+
|                      | [TOPOGR]{.mark}        | [地形分析]{.mark}    |
+----------------------+------------------------+----------------------+
| [2                   | [COSAKE]{.mark}        |                      |
| 进                   |                        |                      |
| 入初始化阶段]{.mark} |                        |                      |
+----------------------+------------------------+----------------------+
|                      | [CONDIN]{.mark}        | [初                  |
|                      |                        | 始化物理变量]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [CLIP]{.mark}          | [修正水深]{.mark}    |
+----------------------+------------------------+----------------------+
|                      | [CELERITE]{.mark}      | [存储波              |
|                      |                        | 速（反射波）]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [BIEF_SUITE]{.mark}    | [读取                |
|                      |                        | 热启动的文件]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [QU QV付给初值]{.mark} | [FV模型              |
|                      |                        | 的变量初始化]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [CHGDIS]{.mark}        | [改变变量的离        |
|                      |                        | 散形式（P1）]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [1]{.mark}             | [初                  |
|                      |                        | 始化气象条件]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [1]{.mark}             | [初                  |
|                      |                        | 始化溃堤条件]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [1]{.mark}             | [初始化涉            |
|                      |                        | 水建筑物条件]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [1]{.mark}             | [初                  |
|                      |                        | 始化湍流模型]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [1]{.mark}             | [与                  |
|                      |                        | 波浪模型和泥沙模型的 |
|                      |                        | 耦合的初始化]{.mark} |
+----------------------+------------------------+----------------------+
| [3                   | [核                    |                      |
| 时间层迭代]{.mark}   | 心的代码部分：]{.mark} |                      |
+----------------------+------------------------+----------------------+
|                      | [CALL BREACH]{.mark}   | [溃堤模型]{.mark}    |
+----------------------+------------------------+----------------------+
|                      | [CALL WAC()]{.mark}    | [波浪模型]{.mark}    |
+----------------------+------------------------+----------------------+
|                      |                        | [参数自动率          |
|                      |                        | 定的时间控制]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [CALL KEPSIN]{.mark}   | [多种模型的          |
|                      |                        | 边界条件代入]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [CALL                  |                      |
|                      | PR                     |                      |
|                      | OPIN_TELEMAC2D]{.mark} |                      |
+----------------------+------------------------+----------------------+
|                      | [CALL                  | [计算                |
|                      | F                      | 河床摩擦阻力]{.mark} |
|                      | RICTION_CHOICE]{.mark} |                      |
+----------------------+------------------------+----------------------+
|                      | [CALL VISTUR]{.mark}   | [计算动力粘滞        |
|                      |                        | 系数，好几种]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [CALL CORVIS]{.mark}   | [校正计算的          |
|                      |                        | 动力粘滞系数]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [CALL PREBOR]{.mark}   | [THOMFR              |
|                      |                        | 边界条件代入]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [CALL BORD]{.mark}     | [用户自定            |
|                      |                        | 义的边界条件]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [CALL                  | [计算LIMPRO CLU CLV  |
|                      | PR                     | CLH]{.mark}          |
|                      | OPIN_TELEMAC2D]{.mark} |                      |
+----------------------+------------------------+----------------------+
|                      | [CALL                  | [计                  |
|                      | WALL_FRICTION]{.mark}  | 算侧向的摩阻]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [CALL KEPSCL]{.mark}   | [紊流模型            |
|                      |                        | 边界条件代入]{.mark} |
+----------------------+------------------------+----------------------+
| [开边                | [CALL THOMPS]{.mark}   | [边界条件处理，见P37 |
| 界条件的处理]{.mark} |                        | 4.2.9]{.mark}        |
+----------------------+------------------------+----------------------+
| [                    | [CALL CHARAC]{.mark}   | [ELM                 |
| 对流项的离散]{.mark} |                        | 法离散对流项]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [CALL PROSOU]{.mark}   | [对流扩散的源项（风  |
|                      |                        | 、科氏力等）]{.mark} |
+----------------------+------------------------+----------------------+
| [【1】               | [CALL PROPAG]{.mark}   | [对流-扩散-源项方    |
| FEM模型和BOUSSINESQ  |                        | 程的离散求解]{.mark} |
| 模型（核心）]{.mark} |                        |                      |
+----------------------+------------------------+----------------------+
|                      | [CALL                  | [自动                |
|                      | PROPAG_ADJ]{.mark}     | 调整参数模块]{.mark} |
+----------------------+------------------------+----------------------+
| [                    | [CALL VOLFIN]{.mark}   | [不连                |
| 【2】FVM模型]{.mark} |                        | 续问题的求解]{.mark} |
+----------------------+------------------------+----------------------+
| [【3】没             | [GESTIO]{.mark}        | [仅管理              |
| 有传播的模拟]{.mark} |                        | 一下变量数组]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [CALL                  | [最后处理            |
|                      | CORRE                  | 下负值的水深]{.mark} |
|                      | CTION_DEPTH_2D]{.mark} |                      |
+----------------------+------------------------+----------------------+
|                      | [CALL DIFFCL]{.mark}   | [标量                |
|                      |                        | 扩散方程求解]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [CALL DIFSOU]{.mark}   | [标量扩              |
|                      |                        | 散方程的源项]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [CALL                  | [溢油模型]{.mark}    |
|                      | OIL_SPILL_2D]{.mark}   |                      |
+----------------------+------------------------+----------------------+
| [DO ITRAC=1,NTRAC    | [CALL CVDFTR]{.mark}   | [标量的对流-扩散     |
| 分组计算]{.mark}     |                        | SOLSYS？？]{.mark}   |
+----------------------+------------------------+----------------------+
|                      | [CALL KEPSIL]{.mark}   | [湍流模型的扩        |
|                      |                        | 散项和源汇项]{.mark} |
+----------------------+------------------------+----------------------+
|                      | [CALL DERIVE]{.mark}   | [浮标的漂浮]{.mark}  |
+----------------------+------------------------+----------------------+
|                      | [CALL DERLAG]{.mark}   | [粒子                |
|                      |                        | 轨迹跟踪模型]{.mark} |
+----------------------+------------------------+----------------------+
| [                    | [CALL SISYPHE]{.mark}  | [泥沙输              |
| 耦合模型计算]{.mark} |                        | 移及河床演变]{.mark} |
+----------------------+------------------------+----------------------+
| [                    | [CALL                  |                      |
| 计算结果输出]{.mark} | PR                     |                      |
|                      | ERES_TELEMAC2D]{.mark} |                      |
+----------------------+------------------------+----------------------+
|                      | [CALL                  | [                    |
|                      | BIEF_DESIMP]{.mark}    | 输出计算结果]{.mark} |
+----------------------+------------------------+----------------------+
| [模型验证]{.mark}    | [CALL                  | [与实测数据          |
|                      | BIEF_VALIDA]{.mark}    | 文件进行比对]{.mark} |
+----------------------+------------------------+----------------------+
