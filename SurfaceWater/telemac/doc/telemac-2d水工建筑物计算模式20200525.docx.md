# TELEMAC-2D模型中水工建筑物模型及设置

## 1 水工建筑物

水工建筑物，即涉水建筑物，包括：节制闸，阻水建筑物，引水堰，过水涵洞以及其他涉及到水流从入流边界过渡到出口边界的水流转换情况，如低水头水泵、淮河水系的节制闸、南水北调闸门、喀斯特溶洞伏流河道等。

TELEMAC-2D模型中使用成对的内边界条件表征水工建筑物（见图1）。根据2个"参考节点"处的水头差计算水流流量，一个节点在上游法向方向，一个在建筑物的下游边（不一定与水工建筑物相邻）。当计算水工建筑物时，假设为各项同性通过一定建筑物宽度的通量边界条件。通过使用经验公式施加边界条件，比如当闸门突然开启或关闭时调整水流。水流输移在入流边和出流边耦合计算。

TELEMAC-2D模型中所有的水工建筑物可使用时间序列的控制参数来控制。水工建筑物也可以在时间序列参数中添加一个合适的标记来撤除，成对边界间的区域可以转换成普通的水流运动方程，好像此时水工建筑物不存在。

![](./media/image1.emf){width="4.2756944444444445in"
height="2.948611111111111in"}

图1 非结构网格上水工建筑物的定义

### 1.1 过渡流

过渡流是一种简单的耦合边界条件流态，规定一个固定值的流量![](./media/image2.wmf)。这个流量施加在水工建筑物进出口边界上，保证质量守恒。

### 1.2围堰

堰可能是出水状态、淹没或自由过流状态，与相对堰底拱高程![](./media/image3.wmf)的上下游水面的位置![](./media/image4.wmf)有关。

对于自由过流状态：

![](./media/image5.wmf) (1)

式中，![](./media/image6.wmf)为通过水工建筑物的流量(m^3^/s)；*sgn*为符号函数；![](./media/image7.wmf)和![](./media/image8.wmf)为上下游水面高程(m)；![](./media/image3.wmf)为堰的底拱高程(m)；![](./media/image9.wmf)为堰的水头；*A*为过水断面面积(m^2^)；![](./media/image10.wmf)为随方向变化的操作系数；![](./media/image11.wmf)为与流态相关的系数；*g*为重力加速度(m/s^2^)。

![](./media/image12.emf){width="3.698611111111111in"
height="2.9680555555555554in"}

图2(a) 自由出流状态的堰；(b)淹没状态的堰

以上计算公式的经验系数取值参考文献(Rantz, 1982)。

淹没状态时的经验公式由自由出流的公式修正得到(Villemonte, 1947)：

![](./media/image13.wmf) (2)

![](./media/image14.wmf) (3)

式中，*S*为淹没修正系数。

如果堰的两边都是干地形状态，即![](./media/image15.wmf)=0。这种状态是相对底拱高程来说的，不是相对河床。

### 1.3 弧形闸门

弧形闸门可以如图3进行参数化，此时忽略了上游水头的动能部分。当弧形闸门完全在水面以上或尾水高程不足以影响上游水位时（*S~p~*\<0.66），弧形闸门可转化为修正的堰流公式。当弧形闸门完全淹没时（*S~p~*\>0.80），弧形闸门可作为孔口出流来处理(1.5节)。

自由水流：

![](./media/image16.wmf) (4)

部分淹没(![](./media/image17.wmf))：

![](./media/image18.wmf) (5)

式中，![](./media/image19.wmf)为淹没比例；![](./media/image20.wmf)为经验系数。

全部淹没(*S*\>*S~f~*)：使用孔口出流公式。

![](./media/image21.emf){width="4.769444444444445in"
height="2.5256944444444445in"}

图3 弧形闸门

### 1.4 线性系数的弧形闸门

另一个可选择的弧形闸门公式(???)。

### 1.5 孔口出流

孔口出流公式是为模拟水闸或闸板等设施，表征一个（矩形的）孔。流量由下式计算：

![](./media/image22.wmf) (6)

一些特殊情况通过系数*A*调整，比如不过水，部分淹没和完全淹没。一般情况下，当全部淹没时孔口公式是最有用的。

### 1.6 过水涵洞

过水涵洞作为圆形孔口出流模拟。也就是说，涵洞计算公式与孔口出流计算公式相同，只是修正系数*A*。该种处理方法忽略了涵洞入口和出口尾水段的局部影响(Bodhaine,
1968)。

涵洞流量由下式计算（水流从1流向2）：

![](./media/image23.wmf)

式中，![](./media/image24.wmf)为横断面面积；![](./media/image25.wmf)和![](./media/image26.wmf)分别为当涵洞以出口方式运行时1和2的水头损失系数；![](./media/image27.wmf)和![](./media/image28.wmf)分别以入口方式运行时1和2的水头损失系数；![](./media/image29.wmf)为线性水头损失系数，一般等于![](./media/image30.wmf)，其中*L*为涵洞长度，*D*为直径，![](./media/image31.wmf)为阻力系数。

### 1.7 堤坝溃决

目前TELEMAC-2D模型中的堤坝溃决仍然采用用户指定的溃决过程文件来定义，尚未包含土工模型的机理模型。

## 2 TELEMAC-2D水工建筑物模拟设置

### 2.1 围堰(WEIR)

可以进行并行计算（从6.2版本开始）。围堰个数由NUMBER OF
WEIRS定义（默认为0）。围堰信息由WEIRS DATA FILE给出。

下面是2个围堰的定义文件：

第2行：围堰个数，围堰上切向流速的处理方法（2中）：0---没有流速（默认）；1---由谢才公式计算流速，是局部水位坡度的函数。

对于每个围堰，需要定义：围堰第1条边的节点数(第5行)，全局节点编号列表（第7行）。

第2条边上的成对节点编号（第9行），采用逆顺序。每对节点的围堰高度（第11行）以及流量系数（第13行）。

用户如要修改围堰流量的计算公式，可修改子程序LOIDEN.f和LOINOY.f。

![](./media/image32.emf){width="4.121527777777778in"
height="4.327083333333333in"}

### 2.2 涵洞(CULVERT)

关键词NUMBER OF CULVERTS定义涵洞个数。涵洞特征信息存储于CULVERT DATA
FILE。

下面的文件示例了1个涵洞的定义：

![](./media/image33.emf){width="2.4166666666666665in"
height="0.1986111111111111in"}

![](./media/image34.emf){width="5.057638888888889in"
height="0.5319444444444444in"}

松弛系数与涵洞的个数。使用松弛系数调节计算涵洞中的流量，避免形成涡旋。在时间*T*的松弛计算，在时刻*T*和前一时间步的计算结果之间执行。松弛系数0.2表示*T*时刻计算值的20%与上一时间计算值的80%混合。

I1和I2是涵洞两端上的全局节点编号。*CE*，*CS*，*S12*，*L12*的意思见上文的公式介绍。

z1和z2为[levels of the
tapers(???)]{.mark}。a1和a2为相对底部的夹角，对于垂直进水口，与底部的夹角就是90°。

d1和d2是与*x*轴的夹角，用来考虑在源汇点处的方向，或不是底部的法向方向。

### 2.3 隧道(TUBE)

隧道允许模拟由明渠流切换到封闭管道流的建筑物，即明满流交替。

NUMBER OF
TUBES指定隧道的个数。隧道可描述为成对的节点，水流穿过其中，这些节点处的流量是水位的函数。与涵洞相反，水流方向自动计算为隧道的入流和出流点的函数。隧道特征信息存储于TUBES
DATA FILE。

下面给出2个隧道的例子：

![](./media/image35.emf){width="5.0256944444444445in"
height="0.9486111111111111in"}

同样，隧道流量也使用松弛系数计算，避免形成涡旋。

I1和I2是隧道两端的全局节点编号。

CE1和CE2是节点作为入口时的水头损失系数。

CS1和CS2是节点作为出口时的水头损失系数。

Lrg是隧道的宽度(m)；Hau是隧道的高度(m)。

Clp是定义检查阀行为的选择开关。有不同的行为选择：

（1）0：允许水流在两个方向上流动；

（2）1：仅允许水流从点1流向点2；

（3）2：仅允许水流从点2流向点1；

（4）3：不允许水流通过（该特性可关闭隧道过流功能）。

L12是线性水头损失系数，通常等于![](./media/image36.wmf)，其中*L*为隧道长度，*D*为直径，![](./media/image37.wmf)为摩阻系数。

z1和z2为[levels of the tapers(???)]{.mark}。

### 2.4 堤坝溃决(DYKE BREACH)

TELEMAC-2D模型中可以模拟堤坝的突然溃决和逐渐溃决，即某些高程点降低。堤坝溃决模块由逻辑关键词BREACH控制。堤坝溃决过程由关键词BREACHES
DATA FILE指定的文件控制。目前有3种溃决过程：

（1）在某个时间突然溃决；

（2）当水位超过堤坝以上的某个阈值；

（3）当水位在某点位处达到某个阈值。

溃堤区域由具有一定宽度的若干点围城的多段线来定义。最终的工况是由溃堤区域内所有点达到一个底部高程来描述。如果在溃堤后，底部高程不是常数，需要将堤坝分解为若干个溃决多段线。

从7.0版本开始，考虑溃堤的侧向展宽过程。

下面是溃堤数据文件，见'breach'算例（文件中的变量意义是自解释的）：

![](./media/image38.emf){width="4.4875in" height="4.269444444444445in"}

![](./media/image39.emf){width="4.519444444444445in"
height="5.628472222222222in"}

## 参考文献

1.  G. L. Bodhaine. 1968. Measurement of peak discharge at culverts by
    > indirect methods, chapter chap. A3.USGS

2.  Saul Edward Rantz. 1982. Measurement and computation of streamflow:
    > Volume 2, Computation of Discharge. Technical Report 2175, USGS

3.  J. R. Villemonte. 1947. Submerged-weir discharge studies.
    > Engineering News Record.
