# shyfem模型的基本原理

## 1、控制方程和边界条件

垂向积分平均的浅水方程：

![](./media/image1.wmf) (1)

![](./media/image2.wmf) (2)

![](./media/image3.wmf) (3)

开边界处给定水位。封闭边界处的法向流速分量为0，切向流速为自由流动。这对应于完全滑移条件。

## 2、模型

使用半隐格式时间离散。空间上，使用有限单元法，不是标准的FEM，而是交错型FEM。

### 2.1时间离散

选择无条件稳定的时间步长![](./media/image4.wmf)，2个动量方程显格式求解，无需求解线性方程组。

需要隐格式求解水位连续方程。相比完全隐格式求解，半隐格式将线程方程组规模减小至1/3，这样可节约求解时间近30倍。

时间步长受CFL条件限制（外模重力波波速）：

![](./media/image5.wmf)

式（1）\~（3）离散如下：

![](./media/image6.wmf)

![](./media/image7.wmf)

![](./media/image8.wmf)

可见：摩阻项采用全隐格式离散，XY项使用全显格式离散，其他项在时间上中心差分。隐格式离散摩阻项是为了当摩阻系数很大时，摩阻项符号改变(Backhaus,
)。

求解未知量*U^n+^*^1^和*V^n+^*^1^：

![](./media/image9.wmf)

求解未知的水位![](./media/image10.wmf)：

![](./media/image11.wmf)

![](./media/image12.wmf)作为已知量。

### 2.2空间离散 {#空间离散 .标题3}

使用交错型有限单元法。对所有的未知量都使用线性三角单元，会导致质量不守恒。另外，线性有限元在求解方程组时，还会引入很高的数值抑制(damping)。为此，水位和流速（动量输移）使用不同阶的形函数，对水位采用标准的线性形函数，而对流速使用分段常数形函数。这将导出类似于有限差分离散中的交错网格。

交错型有限单元法由Schoenstadt()首次引入流体力学，指出非交错的有限单元模型具有很差的地转流调整特性。Williams()推荐了相似算法，SHYFEM采用的算法，为流速引入常值形函数，该格式具有很好的传播和地转流调整特性。

**具体实施**

有限单元方程

## 3、质量守恒

使用标准形式的Galerkin法，模型质量不守恒。

## 4、潮间带

部分计算域，会在高潮位时是淹没区，在低潮位时是岛屿。潮间带水流计算在数值上很难处理，因为该部分网格单元既不是岛屿，也是湿单元。潮间带边界线的等值线随着时间变化而弯弯曲曲，数学模型很难复演这些特这。

为节约计算时间，采用简化算法来表征潮间带。当水位在一个单元的三个节点中，有一个节点上低于最低值（5cm），则认为该单元是岛屿，不进行求解。因为在干节点上不再求解水位，需要使用临近的湿节点上的水位外插得到该节点上的水位值。
