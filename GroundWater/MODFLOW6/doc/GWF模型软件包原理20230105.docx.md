# GWF模型软件包原理

# 第1章 引言

## MODFLOW6框架和GWF模型概览

MODFLOW6使用FORTRAN
2003和部分2008语法的面向对象编程，自下而上对MODFLOW代码重新组织。GWF模型分解为若干\"Package\"，这些软件包用户可能使用，也可能不会使用，可分为三大类型：

（1）Hydrologic/Internal软件包，内部水流软件包，模拟相邻单元的水流或处理所有模型单元中的水存储变化。

（2）Hydrologic/Stress软件包，模拟简化的和某种驱动（如河流、井和充水）。

（3）Hydrologic/Advanced
Stress软件包，模拟更复杂的驱动力，一般涉及求解一些驱动力下的某些形式的水收支方程，如：河网、湖泊、多层含水层中的井或不饱和带。

表1-1列出GWF模型的各种软件包，使用3个简写字母表示。

![](./media/image1.emf){width="4.224758311461067in"
height="3.413982939632546in"}

各水文-驱动力软件包参数化描述某种外部或边界流动的过程，例如River软件包计算描述一个单元与地表河流之间的水流参数。驱动力软件包包括：CHD,
WEL, RCH, RIV, GHB, DRN, EVT，这些软件包在MODFLOW2005中已有。MAW, SFR,
UZF, MVR软件包比以上7个核心软件包更复杂，因此归入Advanced
Stress类型。MODFLOW6的一个特殊功能是：多个相同类型的驱动力和复杂驱动力软件包可以考虑在一个GWF模型中。另一个MODFLOW6的特性是：驱动软件使用时间序列值设置某类型的驱动力输入。

观测OBS和输出控制OC软件包不归入水文类型，管理打印和保存GWF模型的结果到输出文件。一个GWF模型可包包含至多一个OBS软件和一个OC软件的实例。

MODFLOW6支持多模型功能，在模拟层控制关于模拟时间的信息。MODFLOW6的分层级和模拟组件如图1所示，模拟一个GWF模型。

如图2，多个GWF模型相互交换信息(Exchange)，标记为GWF-GWF，可连接任意数目的GWF模型，在矩阵层级(Matrix
Level)耦合，就好像是一个非结构网格模型，高效求解。

## 现有MODFLOW用户指导

（1）MODFLOW6拓展了MODFLOW-USG的概念和功能，多个GWF模型可以紧密耦合。

。。。。。。

（20）GWF模型不包含以下软件包（未来会考虑纳入）：

![](./media/image2.emf){width="4.985452755905512in"
height="2.041362642169729in"}

用户成功实施MODFLOW6的GWF模型模拟，需要首先确定2点：

（1）确定使用何种类型网格：DIS网格简单，方便前后处理，有很多建模工具可供选择使用；而DISV和DISU网格灵活，可重点模拟如井、河网等，但前后处理就困难些。

（2）确定使用何种formulation（标准的或Newton-Raphson）：对承压含水层或有干湿变化的非承压含水层，使用标准公式没有问题。对其他应用，建议使用Newton-Raphson公式。

很大程度上，MODFLOW6就是对MODFLOW-2005、MODFLOW-USG和Newton-Raphson公式的扩展，以及提供Advanced软件包和多个GWF模型在Matrix
Level上的紧密耦合。

# 第2章 有限体积法（CVFD）的数值方法

MODFLOW-2005中，使用有限差分法计算单元间传导项、边界条件传导和定义的水流，称之为"标准公式"。

Newton-Raphson法广泛用于求解非承压层地下水流问题，可改善单元干湿变化引起的收敛问题。

## 数学模型

## 控制体有限差分法

## 模型单元结构

## 单元间的连接

## 模型网格

## 单元间流动（内部流动）

## 外部源汇（外部流动）

## 控制体有限差分离散

# 第3章 空间离散

# 第4章 内部流动软件

MODFLOW6模拟内部流动主要是Node-Property Flow
(NPF)，一个GWF模型仅能定义一个NPF软件。

本章还介绍HFB和GNC软件包，辅助NPF软件。一个GWF模型仅能定义一个HFB和GNC软件。

## NPF软件包

NPF软件取代之前版本的MODFLOW的BCF, LPF和UPW软件。

NPF软件计算相邻单元之间的水力传导，包括水平向和垂向。水储存计算是之前版本MODFLOW的BCF和LPF软件，移到MODFLOW6的STO软件。STO软件包与NPF软件独立。

## HFB软件

模拟很薄、垂直的和低渗透的地质特征（障碍）是HFB软件。

图4-8显示了一个模型层包含低渗透障碍的概念图。HFB软件调整水平向内部流动软件计算的水力传导来考虑障碍。HFB不完全是内部流动软件，但可以视为对NPF软件的补充。

障碍位于水平向连接的2个有限差分单元之间公共界面上，如图4-8

## GNC软件

有时2个单元之间的连接违反CVFD的要求，考虑到连接的几何特性。Panday and
others
(2013)引入"虚拟节点修正"软件，用户可以打开和关闭。MODFLOW-USG中的GNC方程在MODFLOW6的GNC软件中实施了。

GNC软件是高阶修正MODFLOW6模拟项的可选项。

# 第5章 水存储(Storage)

STO软件包模拟承压层和非承压层含水存储量变化对MODFLOW6地下水方程的贡献。一个GWF模型只能有一个STO软件包。

存储量对地下水方程的贡献的方程为：

![](./media/image3.emf){width="1.3789938757655293in"
height="0.2613506124234471in"}

# 第6章 驱动软件的概念与实施

## 指定水头（CHD）软件

使用CHD软件指定单元的水头。CHD软件根据用户输入简单地设置一个内部整数编码和水头值，内部整数编码表示：（1）是否水头随时间变化（变化水头的单元）；（2）水头是恒定的；（3）单元内无流动发生（未激活单元）。Numerical
Solution使用该编码决定方程如何处理。

当使用CHD软件时，从CHD输入文件的单元列表读取恒定水头单元数据。

## 井（WEL）软件

WEL软件用于模拟诸如在驱动周期内以一定的速率，从含水层抽水和充水到含水层的井，其中速率与单元面积和井内水头无关。

## Recharge（RCH）软件

RCH软件用于模拟面上分布式的对地下水系统的充水。通常情况是，降雨渗透到地下水系统的面上充水。

## GHB软件

GHB软件的作用是模拟从外部源进出一个单元(n)的水流，与单元中的水头和分配到外部源的水头之差有关。

## RIVER软件

RIV软件只模拟河道-含水层渗流，不计算河道内水流运动。如果考虑水流运动，需要使用SFR软件。

## 排水(DRN)软件

DRAIN
(DRN)软件用来模拟由于农业灌溉、泉水和其他特征引起的，从含水层中以一定的含水层中水头差或一些固定水头或高度有关的速率比例抽取水，只要含水层水头高于排水高度。但是，当含水层水头低于抽取高程，排水对含水层没有影响。比例常数称为排水传导度。

## 蒸散发软件

蒸散发（EVT）软件模拟植物蒸散发和从饱和地下水区域损失水部分的直接蒸发。可使用下一章的UZF软件表征非饱和带中的蒸散发。MODFLOW6中的ET软件包含指定多个线性ET分段的功能。

## 驱动软件总结

图6-16显示了本报告介绍的6个软件的包含一个驱动力*Q~in~*和单元中水头*h*的进入模型的流动图示。定量显示了6个软件的功能区别。

# 第7章 先进的驱动软件包

## Streamflow Routing Package 

SFR软件使用连续方程和分段恒定、均匀和恒定密度河道径流的假设，计算通过矩形河道的水流（可能包含河道、河网、运河和水渠）。河网可能互相连接也可能不连接。

图7-1 MODFLOW规则网格有3行3列以及简单的有6个河段的河网

### 河段的顺序和编码 {#河段的顺序和编码 .标题3}

### 河段-含水层连接 {#河段-含水层连接 .标题3}

### 河段水量收支 {#河段水量收支 .标题3}

### 计算河段长度 {#计算河段长度 .标题3}

### 分叉河段 {#分叉河段 .标题3}

### 假设和局限性 {#假设和局限性 .标题3}

（1）仅能表征宽浅的矩形横断面和单一Manning糙率系数的河网河段；

（2）在各河段中点处计算水深，可能不能总是收敛到稳定数值解，因为计算水位之间的相关性和使用Newton-Raphson法计算的渗流；

（3）河段之间的水流仅根据连续方程求解，因此不建议用于模拟河段之间过渡性的水流交换或检验快速变化短时间（分钟\~天）内的河道浅水流动。

### 渗流考虑进入地下水方程 {#渗流考虑进入地下水方程 .标题3}

## Lake软件

定量计算湖泊与相邻含水层之间的水动力关系，用来评估两个区域之间通过分离土壤层的水交换。LAK软件应用Darcy定律和湖水位与含水层水头差计算的渗流。

### 湖泊-含水层连接 {#湖泊-含水层连接 .标题3}

### 湖泊出口 {#湖泊出口 .标题3}

### 湖泊水量收支 {#湖泊水量收支 .标题3}

### 计算湖泊水位 {#计算湖泊水位 .标题3}

### 湖泊断面的drying和rewetting {#湖泊断面的drying和rewetting .标题3}

### 渗流考虑进入地下水方程 {#渗流考虑进入地下水方程-1 .标题3}

## 非饱和带流动软件包

非饱和隔开含水层与地表。水流通过非饱和带是重要的过程，影响含水层补水的时间和速率。UZF软件模拟通过非饱和带的水流，将计算的补水增加到地下水的CVFD方程（图7-14）。

垂向流动通过一个各向同性的非饱和带，使用动力波近似，在垂向维度上通过简化的Richards方程做近似：

### 湿润前锋和排水剖面 {#湿润前锋和排水剖面 .标题3}

### 非饱和带的蒸散发 {#非饱和带的蒸散发 .标题3}

### 饱和带的蒸散发 {#饱和带的蒸散发 .标题3}

### 渗透边界 {#渗透边界 .标题3}

### 地下水渗流边界 {#地下水渗流边界 .标题3}

### 径流(Runoff) {#径流runoff .标题3}

### 局限 {#局限 .标题3}

UZF的主要假设是当相对重力势梯度，负压力梯度很大，不考虑毛细管引起的湿润面上的渗透。忽略毛细管压力，当降雨量大于饱和垂向水力传导度以及驱动周期小于1天时，UZF软件可能导出错误的模拟渗透。

## Water Mover Package 

主要是为了基于管理的水量在不同软件包之间的转移。可用于4个先进软件包MAW,
SFR, LAKE, UZF，部分功能用于WEL, DRN, RIV, GHB等4个基础软件。

# 第8章 GWF模型之间的交换

2个或多个GWF模型相互耦合，有4种情况，类似USG和LGR模型。

2个GWF模型之间的cell-to-cell连接，用户需要提供需要计算2个连接单元之间水流传导的信息。连接信息与下面使用DISU软件包定义一个GWF模型需要的信息类似：

![](./media/image4.emf){width="5.059879702537183in"
height="2.108160542432196in"}

以上信息，连接饱和厚度和各模型中的连接单元的水力传导度，计算连接的传导。GWF模型交换计算不同模型的2单元间的传导，与NPF软件计算2相邻单元的传导的方法一样。

GWF-GWF耦合模型可以使用GNC和MVR软件包。

局限性：

与边界软件包有关的GWF模型交换有限制：必须确定最高的激活的GWF模型单元。RCH软件就是一个例子。可能与这个问题（施加水流到最高的激活单元）有关的软件包（EVT,
SFR, LAK, UZF）。
